<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>YoRHa Evolution - Protocol</title>
    <style>
        :root {
            --yorha-bg: #c8c2b1;
            --yorha-dark: #454138;
            --yorha-white: #ffffff;
            --yorha-accent: #ff5555;
        }

        * { -webkit-tap-highlight-color: transparent; outline: none; user-select: none; box-sizing: border-box; }
        
        body { 
            margin: 0; padding: 0; height: 100vh; 
            background-color: #000; 
            font-family: 'Courier New', monospace; 
            color: var(--yorha-white);
            overflow: hidden; display: flex; flex-direction: column; align-items: center; 
        }

        /* الخلفية والجماليات */
        .scanlines {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: linear-gradient(rgba(18, 16, 16, 0) 50%, rgba(0, 0, 0, 0.1) 50%);
            background-size: 100% 4px; pointer-events: none; z-index: 100;
        }

        /* الهيدر العلوي */
        .header-stats {
            width: 100%; display: flex; justify-content: space-around; 
            padding: 20px 0; border-bottom: 1px solid rgba(255,255,255,0.2);
            background: rgba(255,255,255,0.05); z-index: 50;
        }
        .stat-box { font-size: 14px; letter-spacing: 2px; font-weight: bold; }

        /* منطقة الضغط */
        .main-interact { flex: 1; display: flex; flex-direction: column; justify-content: center; align-items: center; width: 100%; position: relative; }
        .image-container {
            width: 250px; height: 330px; border: 1.5px solid var(--yorha-white);
            position: relative; background: #111; overflow: hidden;
        }
        .image-container img { position: absolute; width: 100%; height: 100%; object-fit: cover; }
        #imgPress { opacity: 0; }
        .image-container:active #imgIdle { opacity: 0; }
        .image-container:active #imgPress { opacity: 1; }

        /* الأزرار الجانبية (إعدادات وأحداث) */
        .side-controls {
            position: absolute; width: 100%; top: 85px; padding: 0 20px;
            display: flex; justify-content: space-between; z-index: 60;
        }
        .yorha-btn-mini {
            background: rgba(255,255,255,0.1); border: 1px solid var(--yorha-white);
            color: white; padding: 8px 15px; font-size: 10px; cursor: pointer;
            letter-spacing: 2px; text-transform: uppercase;
        }

        /* المودالات (النوافذ المنبثقة) بأسلوب الكود الذي أرفقته */
        .modal {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0, 0, 0, 0.9); display: none; 
            justify-content: center; align-items: center; z-index: 1000;
        }
        .modal-content { 
            background: #111; border: 1.5px solid var(--yorha-white); 
            padding: 25px; width: 280px; text-align: center; 
        }
        .modal-title { color: white; font-size: 0.9rem; letter-spacing: 3px; margin-bottom: 20px; border-bottom: 1px solid #444; padding-bottom: 10px; }

        /* نافذة الأحداث 1:1 */
        #eventModal .modal-content {
            width: 320px; height: 320px; padding: 0; overflow: hidden; position: relative;
        }
        #eventFrame { width: 100%; height: 100%; border: none; }
        .close-event { position: absolute; bottom: 10px; left: 50%; transform: translateX(-50%); }

        /* الإعدادات */
        .setting-row { margin: 15px 0; text-align: left; font-size: 10px; letter-spacing: 1px; }
        input[type=range] { width: 100%; accent-color: var(--yorha-accent); }
        .danger-btn { background: var(--yorha-accent); color: white; border: none; padding: 10px; width: 100%; margin-top: 10px; font-weight: bold; cursor: pointer; }
        .cancel-btn { color: #888; font-size: 9px; margin-top: 15px; cursor: pointer; text-decoration: underline; }

        /* شريط التنقل السفلي */
        .nav-bar { width: 100%; height: 60px; background: #000; border-top: 1px solid var(--yorha-white); display: flex; z-index: 100; }
        .nav-link { flex: 1; display: flex; justify-content: center; align-items: center; color: #fff; text-decoration: none; font-size: 11px; letter-spacing: 2px; border-right: 1px solid #222; }

        /* أنظمة الـ VFX */
        .heart { position: absolute; pointer-events: none; animation: float 0.8s forwards; z-index: 200; width: 30px; }
        @keyframes float { 0% { transform: translateY(0) scale(1); opacity: 1; } 100% { transform: translateY(-100px) scale(1.5); opacity: 0; } }
    </style>
</head>
<body>

    <div class="scanlines"></div>

    <div class="header-stats">
        <div class="stat-box">GOLD: <span id="g-val">0</span></div>
        <div class="stat-box">DIAMOND: <span id="d-val">0</span></div>
    </div>

    <div class="side-controls">
        <button class="yorha-btn-mini" onclick="openModal('settingsModal')">Settings</button>
        <button class="yorha-btn-mini" onclick="openEvent()">Events</button>
    </div>

    <div class="main-interact">
        <div style="font-size: 11px; margin-bottom: 10px;">LVL: <span id="lvl-display">1</span></div>
        <div class="image-container" id="target" onpointerdown="doTap(event)">
            <img id="imgIdle" src="unit1_idle.jpg">
            <img id="imgPress" src="unit1_press.jpg">
        </div>
    </div>

    <div class="modal" id="settingsModal">
        <div class="modal-content">
            <div class="modal-title">SYSTEM SETTINGS</div>
            <div class="setting-row">
                MASTER VOLUME <span id="vol-txt">100%</span>
                <input type="range" id="volRange" min="0" max="1" step="0.1" value="1" oninput="updateVol(this.value)">
            </div>
            <button class="danger-btn" onclick="location.href='index.html'">ABORT MISSION (EXIT)</button>
            <p class="cancel-btn" onclick="closeModal('settingsModal')">[ BACK TO INTERFACE ]</p>
        </div>
    </div>

    <div class="modal" id="eventModal">
        <div class="modal-content">
            <iframe id="eventFrame" src=""></iframe>
            <button class="yorha-btn-mini close-event" onclick="closeEvent()">[ CLOSE ]</button>
        </div>
    </div>

    <nav class="nav-bar">
        <a href="Shop.html" class="nav-link">SHOP</a>
        <a href="Career.html" class="nav-link">MINE</a>
        <a href="Imgs.html" class="nav-link">IMGS</a>
    </nav>

    <script src="Skins.js"></script>
    <script>
        // نظام البيانات
        const Data = {
            save: (s) => {
                localStorage.setItem('yorha_gold', s.gold);
                localStorage.setItem('yorha_diamonds', s.diamonds);
                localStorage.setItem('yorha_lvl', s.level);
                localStorage.setItem('tap_progress', s.taps);
                localStorage.setItem('yorha_vol', s.volume);
            },
            load: () => ({
                gold: parseInt(localStorage.getItem('yorha_gold')) || 0,
                diamonds: parseInt(localStorage.getItem('yorha_diamonds')) || 0,
                level: parseInt(localStorage.getItem('yorha_lvl')) || 1,
                taps: parseInt(localStorage.getItem('tap_progress')) || 0,
                volume: parseFloat(localStorage.getItem('yorha_vol')) || 1
            })
        };

        const audioNodes = Array.from({length: 20}, (_, i) => new Audio(`Sexy sound ${i+1}.ogg`));

        function updateVol(v) {
            const s = Data.load();
            s.volume = v;
            Data.save(s);
            document.getElementById('vol-txt').innerText = Math.round(v * 100) + "%";
        }

        function openModal(id) { document.getElementById(id).style.display = 'flex'; }
        function closeModal(id) { document.getElementById(id).style.display = 'none'; }

        function openEvent() {
            document.getElementById('eventFrame').src = 'event.html';
            openModal('eventModal');
        }

        function closeEvent() {
            document.getElementById('eventFrame').src = '';
            closeModal('eventModal');
        }

        function doTap(e) {
            const s = Data.load();
            
            // صوت
            const audio = audioNodes[Math.floor(Math.random() * audioNodes.length)];
            audio.volume = s.volume;
            audio.currentTime = 0;
            audio.play().catch(()=>{});

            // VFX
            const h = document.createElement('img');
            h.src = "Heart.png"; h.className = 'heart';
            h.style.left = (e.clientX - 15) + 'px';
            h.style.top = (e.clientY - 15) + 'px';
            document.body.appendChild(h);
            setTimeout(() => h.remove(), 800);

            // حسابات
            s.gold += s.level;
            s.taps++;
            if(s.taps >= 500) { s.level++; s.taps = 0; }
            if(s.taps % 10 === 0) s.diamonds += Math.max(1, Math.floor(s.level/10));

            Data.save(s);
            updateUI();
        }

        function updateUI() {
            const s = Data.load();
            document.getElementById('g-val').innerText = s.gold;
            document.getElementById('d-val').innerText = s.diamonds;
            document.getElementById('lvl-display').innerText = s.level;
            document.getElementById('volRange').value = s.volume;
            document.getElementById('vol-txt').innerText = Math.round(s.volume * 100) + "%";
        }

        window.onload = updateUI;
    </script>
</body>
</html>
